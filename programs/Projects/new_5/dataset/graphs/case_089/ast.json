[
  {
    "name": "init_engine",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < InitEngine >",
      "engine_id: u64",
      "base_energy: u64"
    ],
    "attributes": [],
    "body": [
      "let engine = & mut ctx . accounts . engine_core ;",
      "engine . engine_id = engine_id << 4 ;",
      "engine . energy_level = base_energy * 100 ;",
      "engine . fragment_count = 0 ;",
      "engine . is_operational = engine . energy_level > 1000 ;",
      "msg ! (\"Void Engine {} activated with {} energy.\" , engine . engine_id , engine . energy_level) ;",
      "Ok (())"
    ]
  },
  {
    "name": "init_fragment",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < InitFragment >",
      "fragment_id: u64",
      "efficiency: u32"
    ],
    "attributes": [],
    "body": [
      "let fragment = & mut ctx . accounts . fragment_data ;",
      "fragment . parent_engine = ctx . accounts . engine_core . key () ;",
      "if let Some (fid) = fragment_id . checked_add (1000)",
      "{",
      "fragment . fragment_id = fid ;",
      "} else",
      "{",
      "fragment . fragment_id = u64 :: MAX ;",
      "}",
      "fragment . efficiency = efficiency / 2 ;",
      "fragment . is_active = true ;",
      "fragment . processed_count = 0 ;",
      "msg ! (\"New fragment {} linked with efficiency {}.\" , fragment . fragment_id , fragment . efficiency) ;",
      "Ok (())"
    ]
  },
  {
    "name": "process_fragments",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < ProcessFragments >",
      "cycles: u32"
    ],
    "attributes": [],
    "body": [
      "let engine = & mut ctx . accounts . engine_core ;",
      "let core_fragment = & mut ctx . accounts . core_fragment ;",
      "let peripheral_fragment = & mut ctx . accounts . peripheral_fragment ;",
      "let mut loop_counter = cycles ;",
      "while loop_counter > 0",
      "{",
      "let energy_gain_core = (core_fragment . efficiency as u64) * 10 ;",
      "engine . energy_level = engine . energy_level . saturating_add (energy_gain_core) ;",
      "core_fragment . processed_count = core_fragment . processed_count . saturating_add (1) ;",
      "core_fragment . is_active = core_fragment . efficiency > 50 && engine . is_operational ;",
      "let energy_gain_peripheral = (peripheral_fragment . efficiency as u64) * 20 ;",
      "engine . energy_level = engine . energy_level . saturating_add (energy_gain_peripheral) ;",
      "peripheral_fragment . processed_count = peripheral_fragment . processed_count . saturating_add (1) ;",
      "peripheral_fragment . is_active = peripheral_fragment . efficiency > 60 && engine . is_operational ;",
      "engine . fragment_count = (core_fragment . is_active as u32) + (peripheral_fragment . is_active as u32) ;",
      "engine . is_operational = engine . energy_level > 500 && engine . fragment_count > 0 ;",
      "loop_counter = loop_counter . saturating_sub (1) ;",
      "}",
      "msg ! (\"Engine processed fragments for {} cycles. Current energy level is {}. Active fragments: {}.\" , cycles , engine . energy_level , engine . fragment_count) ;",
      "Ok (())"
    ]
  },
  {
    "name": "InitEngine",
    "node_type": "struct",
    "fields": [
      {
        "name": "engine_core",
        "attribute": "# [account (init , payer = signer , space = 8 + 8 + 8 + 4 + 1)]",
        "field_type": "Account < 'info , EngineCore >"
      },
      {
        "name": "signer",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "InitFragment",
    "node_type": "struct",
    "fields": [
      {
        "name": "fragment_data",
        "attribute": "# [account (init , payer = signer , space = 8 + 32 + 8 + 4 + 1 + 4)]",
        "field_type": "Account < 'info , FragmentData >"
      },
      {
        "name": "engine_core",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , EngineCore >"
      },
      {
        "name": "signer",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "ProcessFragments",
    "node_type": "struct",
    "fields": [
      {
        "name": "engine_core",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , EngineCore >"
      },
      {
        "name": "core_fragment",
        "attribute": "# [account (mut , has_one = parent_engine)]",
        "field_type": "Account < 'info , FragmentData >"
      },
      {
        "name": "peripheral_fragment",
        "attribute": "# [account (mut , has_one = parent_engine)]",
        "field_type": "Account < 'info , FragmentData >"
      },
      {
        "name": "signer",
        "attribute": null,
        "field_type": "Signer < 'info >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "EngineCore",
    "node_type": "struct",
    "fields": [
      {
        "name": "engine_id",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "energy_level",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "fragment_count",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "is_operational",
        "attribute": null,
        "field_type": "bool"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "FragmentData",
    "node_type": "struct",
    "fields": [
      {
        "name": "parent_engine",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "fragment_id",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "efficiency",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "is_active",
        "attribute": null,
        "field_type": "bool"
      },
      {
        "name": "processed_count",
        "attribute": null,
        "field_type": "u32"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]