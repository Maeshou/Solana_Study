[
  {
    "name": "start_rental",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < StartRental >",
      "fee: u64",
      "duration_secs: i64",
      "note_suffix: String"
    ],
    "attributes": [
      "# [doc = \" landlord_profile と tenant_profile を操作してレンタルを開始するが、\"]",
      "# [doc = \" 同一アカウントチェックが抜けている Duplicate Mutable Account 脆弱性あり\"]"
    ],
    "body": [
      "let landlord = & mut ctx . accounts . landlord_profile ;",
      "let tenant = & mut ctx . accounts . tenant_profile ;",
      "let nft = & mut ctx . accounts . nft ;",
      "let now = ctx . accounts . clock . unix_timestamp ;",
      "landlord . rental_count = landlord . rental_count + 1 ;",
      "tenant . rental_count = tenant . rental_count + 1 ;",
      "landlord . total_earned = landlord . total_earned + fee ;",
      "tenant . total_paid = tenant . total_paid + fee ;",
      "landlord . next_due = now + duration_secs ;",
      "tenant . next_due = now + duration_secs ;",
      "nft . is_rented = true ;",
      "landlord . note = format ! (\"{};auto-{}\" , landlord . note , note_suffix) ;",
      "tenant . note = format ! (\"{};auto-{}\" , tenant . note , note_suffix) ;",
      "msg ! (\"Rental started: NFT {} rented for {}s by {} → fee {} lamports\" , nft . id , duration_secs , ctx . accounts . operator . key () , fee) ;",
      "Ok (())"
    ]
  },
  {
    "name": "end_rental",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "_ctx: Context < EndRental >"
    ],
    "attributes": [
      "# [doc = \" レンタル終了処理（省略）\"]"
    ],
    "body": [
      "Ok (())"
    ]
  },
  {
    "name": "StartRental",
    "node_type": "struct",
    "fields": [
      {
        "name": "landlord_profile",
        "attribute": "# [doc = \" レンタルを貸し出す側のプロファイル（mutable）\"] # [account (mut)]",
        "field_type": "Account < 'info , RentalProfile >"
      },
      {
        "name": "tenant_profile",
        "attribute": "# [doc = \" レンタルを借りる側のプロファイル（mutable）\"] # [account (mut)]",
        "field_type": "Account < 'info , RentalProfile >"
      },
      {
        "name": "nft",
        "attribute": "# [doc = \" レンタル対象の NFT\"] # [account (mut)]",
        "field_type": "Account < 'info , GameNft >"
      },
      {
        "name": "operator",
        "attribute": "# [doc = \" 操作を実行するオペレーター（署名者）\"] # [account (signer)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "clock",
        "attribute": "# [doc = \" 時刻取得用 Sysvar\"]",
        "field_type": "Sysvar < 'info , Clock >"
      },
      {
        "name": "system_program",
        "attribute": "# [doc = \" システムプログラム\"]",
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "EndRental",
    "node_type": "struct",
    "fields": [
      {
        "name": "landlord_profile",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , RentalProfile >"
      },
      {
        "name": "tenant_profile",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , RentalProfile >"
      },
      {
        "name": "nft",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , GameNft >"
      },
      {
        "name": "operator",
        "attribute": "# [account (signer)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "clock",
        "attribute": null,
        "field_type": "Sysvar < 'info , Clock >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "RentalProfile",
    "node_type": "struct",
    "fields": [
      {
        "name": "owner",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "rental_count",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "total_earned",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "total_paid",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "next_due",
        "attribute": null,
        "field_type": "i64"
      },
      {
        "name": "note",
        "attribute": null,
        "field_type": "String"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "GameNft",
    "node_type": "struct",
    "fields": [
      {
        "name": "owner",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "id",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "name",
        "attribute": null,
        "field_type": "String"
      },
      {
        "name": "is_rented",
        "attribute": null,
        "field_type": "bool"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]