[
  {
    "name": "init_raid_board",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < InitRaidBoard >",
      "stage: u8"
    ],
    "attributes": [],
    "body": [
      "let board = & mut ctx . accounts . board ;",
      "board . stage = stage ;",
      "board . owner = ctx . accounts . initiator . key () ;",
      "Ok (())"
    ]
  },
  {
    "name": "register_entity",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < RegisterEntity >",
      "tag: u8"
    ],
    "attributes": [],
    "body": [
      "let entity = & mut ctx . accounts . entity ;",
      "entity . board = ctx . accounts . board . key () ;",
      "entity . role_tag = tag ;",
      "entity . value = 0 ;",
      "Ok (())"
    ]
  },
  {
    "name": "contribute_score",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < ContributeScore >",
      "points: Vec < u32 >"
    ],
    "attributes": [],
    "body": [
      "let board = & mut ctx . accounts . board ;",
      "let source = & mut ctx . accounts . source ;",
      "let target = & mut ctx . accounts . target ;",
      "let mut sum = 0u32 ;",
      "for p in points",
      "{",
      "sum = sum . checked_add (p) . unwrap_or (u32 :: MAX) ;",
      "}",
      "if sum % 2 == 0",
      "{",
      "target . value = target . value . saturating_add (sum as u64) ;",
      "board . stage = board . stage . wrapping_add (1) ;",
      "} else",
      "{",
      "source . value = source . value . saturating_sub ((sum / 2) as u64) ;",
      "board . stage = board . stage . wrapping_sub (1) ;",
      "}",
      "msg ! (\"Score updated. Source: {}, Target: {}, Board Stage: {}\" , source . value , target . value , board . stage) ;",
      "Ok (())"
    ]
  },
  {
    "name": "InitRaidBoard",
    "node_type": "struct",
    "fields": [
      {
        "name": "board",
        "attribute": "# [account (init , payer = initiator , space = 8 + 32 + 1)]",
        "field_type": "Account < 'info , RaidBoard >"
      },
      {
        "name": "initiator",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "RegisterEntity",
    "node_type": "struct",
    "fields": [
      {
        "name": "entity",
        "attribute": "# [account (init , payer = creator , space = 8 + 32 + 1 + 8)]",
        "field_type": "Account < 'info , EntityCard >"
      },
      {
        "name": "creator",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "board",
        "attribute": null,
        "field_type": "Account < 'info , RaidBoard >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "ContributeScore",
    "node_type": "struct",
    "fields": [
      {
        "name": "board",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , RaidBoard >"
      },
      {
        "name": "source",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , EntityCard >"
      },
      {
        "name": "target",
        "attribute": "# [account (mut)]",
        "field_type": "Account < 'info , EntityCard >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "RaidBoard",
    "node_type": "struct",
    "fields": [
      {
        "name": "owner",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "stage",
        "attribute": null,
        "field_type": "u8"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "EntityCard",
    "node_type": "struct",
    "fields": [
      {
        "name": "board",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "role_tag",
        "attribute": null,
        "field_type": "u8"
      },
      {
        "name": "value",
        "attribute": null,
        "field_type": "u64"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]