[
  {
    "name": "Hotel",
    "node_type": "struct",
    "fields": [
      {
        "name": "manager",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "total_reservations",
        "attribute": null,
        "field_type": "u64"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "Reservation",
    "node_type": "struct",
    "fields": [
      {
        "name": "guest",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "hotel",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "nights",
        "attribute": null,
        "field_type": "u8"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "BookRoom",
    "node_type": "struct",
    "fields": [
      {
        "name": "hotel",
        "attribute": "# [doc = \" Hotel.manager == manager.key() は検証される\"] # [account (mut , has_one = manager)]",
        "field_type": "Account < 'info , Hotel >"
      },
      {
        "name": "reservation",
        "attribute": "# [doc = \" Reservation.hotel ⇔ hotel.key() の検証がないまま初期化\"] # [account (init , payer = guest , space = 8 + 32 + 32 + 1)]",
        "field_type": "Account < 'info , Reservation >"
      },
      {
        "name": "manager",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "guest",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "ConfirmStay",
    "node_type": "struct",
    "fields": [
      {
        "name": "reservation",
        "attribute": "# [doc = \" Reservation.guest == guest.key() は検証される\"] # [account (mut , has_one = guest)]",
        "field_type": "Account < 'info , Reservation >"
      },
      {
        "name": "hotel",
        "attribute": "# [doc = \" hotel.account と reservation.hotel の一致チェックがない\"] # [account (mut)]",
        "field_type": "Account < 'info , Hotel >"
      },
      {
        "name": "guest",
        "attribute": null,
        "field_type": "Signer < 'info >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "book_room",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < BookRoom >",
      "nights: u8"
    ],
    "attributes": [
      "# [doc = \" ルームを予約\"]"
    ],
    "body": [
      "let h = & mut ctx . accounts . hotel ;",
      "let r = & mut ctx . accounts . reservation ;",
      "r . guest = ctx . accounts . guest . key () ;",
      "r . hotel = h . key () ;",
      "r . nights = nights ;",
      "h . total_reservations += 1 ;",
      "Ok (())"
    ]
  },
  {
    "name": "confirm_stay",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < ConfirmStay >"
    ],
    "attributes": [
      "# [doc = \" 宿泊を確定\"]"
    ],
    "body": [
      "let h = & mut ctx . accounts . hotel ;",
      "h . total_reservations -= 1 ;",
      "Ok (())"
    ]
  }
]