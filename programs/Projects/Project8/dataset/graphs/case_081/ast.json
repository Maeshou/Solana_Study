[
  {
    "name": "scan",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < Scan >",
      "reaction_ms: u32",
      "decision_times: Vec < u32 >",
      "notes: Vec < String >"
    ],
    "attributes": [],
    "body": [
      "let n = decision_times . len () ;",
      "let mut sum = 0u32 ;",
      "let mut i = 0usize ;",
      "while i < n",
      "{",
      "sum = sum . saturating_add (decision_times [i]) ;",
      "i = i . saturating_add (1) ;",
      "}",
      "let mut consistency = 50u32 ;",
      "if n > 0",
      "{",
      "let mean = sum / (n as u32) ;",
      "let mut acc = 0u32 ;",
      "let mut k = 0usize ;",
      "while k < n",
      "{",
      "let d = (decision_times [k] as i32 - mean as i32) . pow (2) as u32 ;",
      "acc = acc . saturating_add (d) ;",
      "k = k . saturating_add (1) ;",
      "} let var = acc / (n as u32) ;",
      "let pen = (var / 100) . min (50) ;",
      "consistency = 100 - pen ;",
      "}",
      "ctx . accounts . report . analysis = GameplayPattern { average_reaction_time : reaction_ms , decision_making_consistency : consistency , input_pattern_variance : reaction_ms / 10 , suspicious_activity_flags : notes , } ;",
      "ctx . accounts . report . checked_at = Clock :: get () ? . unix_timestamp ;",
      "Ok (())"
    ]
  },
  {
    "name": "Scan",
    "node_type": "struct",
    "fields": [
      {
        "name": "report",
        "attribute": "# [account (init , payer = auditor , space = 8 + AntiCheatReport :: LEN , seeds = [b\"anticheat\" , auditor . key () . as_ref ()] , bump)]",
        "field_type": "Account < 'info , AntiCheatReport >"
      },
      {
        "name": "auditor",
        "attribute": "# [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "AntiCheatReport",
    "node_type": "struct",
    "fields": [
      {
        "name": "analysis",
        "attribute": null,
        "field_type": "GameplayPattern"
      },
      {
        "name": "checked_at",
        "attribute": null,
        "field_type": "i64"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "GameplayPattern",
    "node_type": "struct",
    "fields": [
      {
        "name": "average_reaction_time",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "decision_making_consistency",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "input_pattern_variance",
        "attribute": null,
        "field_type": "u32"
      },
      {
        "name": "suspicious_activity_flags",
        "attribute": null,
        "field_type": "Vec < String >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]