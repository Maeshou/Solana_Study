[
  {
    "name": "start_quest",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < ModifyQuest >",
      "quest_id: u8"
    ],
    "attributes": [
      "# [doc = \" クエストを開始し、開始回数を記録するが、\"]",
      "# [doc = \" quest_account.owner と ctx.accounts.user.key() の一致検証がない\"]"
    ],
    "body": [
      "let quest = & mut ctx . accounts . quest_account ;",
      "record_start (quest , quest_id) ;",
      "Ok (())"
    ]
  },
  {
    "name": "complete_quest",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < ModifyQuest >"
    ],
    "attributes": [
      "# [doc = \" クエストを完了し、XPを付与するが、\"]",
      "# [doc = \" quest_account.owner と ctx.accounts.user.key() の一致検証がない\"]"
    ],
    "body": [
      "let quest = & mut ctx . accounts . quest_account ;",
      "let xp = get_reward_xp (& ctx . accounts . config) ;",
      "record_completion (quest , xp) ;",
      "Ok (())"
    ]
  },
  {
    "name": "record_start",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "quest: & mut QuestAccount",
      "quest_id: u8"
    ],
    "attributes": [
      "# [doc = \" クエスト開始時の状態を更新するヘルパー関数\"]"
    ],
    "body": [
      "quest . quest_id = quest_id ;",
      "quest . started = true ;",
      "quest . start_count = quest . start_count . checked_add (1) . unwrap () ;"
    ]
  },
  {
    "name": "get_reward_xp",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "config: & Account < QuestConfig >"
    ],
    "attributes": [
      "# [doc = \" 設定アカウントからXP報酬を取得するヘルパー関数\"]"
    ],
    "body": [
      "config . xp_reward"
    ]
  },
  {
    "name": "record_completion",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "quest: & mut QuestAccount",
      "xp: u64"
    ],
    "attributes": [
      "# [doc = \" クエスト完了時の状態を更新するヘルパー関数\"]"
    ],
    "body": [
      "quest . started = false ;",
      "quest . total_xp = quest . total_xp . checked_add (xp) . unwrap () ;",
      "quest . complete_count = quest . complete_count . checked_add (1) . unwrap () ;"
    ]
  },
  {
    "name": "ModifyQuest",
    "node_type": "struct",
    "fields": [
      {
        "name": "quest_account",
        "attribute": "# [account (mut)] # [doc = \" 本来は #[account(has_one = owner)] を指定して所有者照合を行うべき\"]",
        "field_type": "Account < 'info , QuestAccount >"
      },
      {
        "name": "user",
        "attribute": "# [doc = \" 操作をリクエストするユーザー（署名者）\"]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "config",
        "attribute": "# [doc = \" XP報酬量を保持する設定アカウント\"]",
        "field_type": "Account < 'info , QuestConfig >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "QuestAccount",
    "node_type": "struct",
    "fields": [
      {
        "name": "owner",
        "attribute": "# [doc = \" 本来このクエストを所有するべきユーザーの Pubkey\"]",
        "field_type": "Pubkey"
      },
      {
        "name": "quest_id",
        "attribute": "# [doc = \" 現在のクエストID\"]",
        "field_type": "u8"
      },
      {
        "name": "started",
        "attribute": "# [doc = \" クエスト中フラグ\"]",
        "field_type": "bool"
      },
      {
        "name": "start_count",
        "attribute": "# [doc = \" 開始した回数\"]",
        "field_type": "u64"
      },
      {
        "name": "complete_count",
        "attribute": "# [doc = \" 完了した回数\"]",
        "field_type": "u64"
      },
      {
        "name": "total_xp",
        "attribute": "# [doc = \" 累計XP\"]",
        "field_type": "u64"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "QuestConfig",
    "node_type": "struct",
    "fields": [
      {
        "name": "xp_reward",
        "attribute": "# [doc = \" クエスト完了ごとに付与するXP量\"]",
        "field_type": "u64"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]