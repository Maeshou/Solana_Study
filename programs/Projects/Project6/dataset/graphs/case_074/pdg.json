[
  {
    "name": "repair_item_durability",
    "inputs": [
      "ctx: Context < RepairItem >",
      "kit_amount_to_use: u32"
    ],
    "nodes": [
      {
        "id": 0,
        "label": "Entry"
      },
      {
        "id": 1,
        "label": "let weapon = & mut ctx . accounts . weapon_to_repair ;"
      },
      {
        "id": 2,
        "label": "let inventory = & mut ctx . accounts . player_inventory ;"
      },
      {
        "id": 3,
        "label": "let repair_kit_id = 777 ;"
      },
      {
        "id": 4,
        "label": "let durability_per_kit = 25 ;"
      },
      {
        "id": 5,
        "label": "let total_recovery = durability_per_kit . saturating_mul (kit_amount_to_use) ;"
      },
      {
        "id": 6,
        "label": "let recovered_durability = weapon . current_durability . saturating_add (total_recovery) ;"
      },
      {
        "id": 7,
        "label": "weapon . current_durability = recovered_durability . min (weapon . max_durability) ;"
      },
      {
        "id": 8,
        "label": "let mut kits_to_consume = kit_amount_to_use ;"
      },
      {
        "id": 9,
        "label": "inventory . items . iter_mut () . filter (| item | item . item_id == repair_kit_id) . for_each (| kit | { let amount_to_use = kit . quantity . min (kits_to_consume) ; kit . quantity -= amount_to_use ; kits_to_consume -= amount_to_use ; }) ;"
      },
      {
        "id": 10,
        "label": "let amount_to_use = kit . quantity . min (kits_to_consume) ;"
      },
      {
        "id": 11,
        "label": "kit . quantity -= amount_to_use ;"
      },
      {
        "id": 12,
        "label": "kits_to_consume -= amount_to_use ;"
      },
      {
        "id": 13,
        "label": "inventory . items . retain (| item | item . quantity > 0) ;"
      },
      {
        "id": 14,
        "label": "msg ! (\"Weapon durability repaired to {}\" , weapon . current_durability) ;"
      },
      {
        "id": 15,
        "label": "Ok (())"
      }
    ],
    "edges": [
      {
        "from": 1,
        "to": 1,
        "label": "def: weapon"
      },
      {
        "from": 2,
        "to": 2,
        "label": "def: inventory"
      },
      {
        "from": 3,
        "to": 3,
        "label": "def: repair_kit_id"
      },
      {
        "from": 4,
        "to": 4,
        "label": "def: durability_per_kit"
      },
      {
        "from": 5,
        "to": 5,
        "label": "def: total_recovery"
      },
      {
        "from": 4,
        "to": 5,
        "label": "data_dep: durability_per_kit"
      },
      {
        "from": 6,
        "to": 6,
        "label": "def: recovered_durability"
      },
      {
        "from": 1,
        "to": 6,
        "label": "data_dep: weapon"
      },
      {
        "from": 5,
        "to": 6,
        "label": "data_dep: total_recovery"
      },
      {
        "from": 1,
        "to": 7,
        "label": "data_dep: weapon"
      },
      {
        "from": 6,
        "to": 7,
        "label": "data_dep: recovered_durability"
      },
      {
        "from": 1,
        "to": 7,
        "label": "data_dep: weapon"
      },
      {
        "from": 8,
        "to": 8,
        "label": "def: kits_to_consume"
      },
      {
        "from": 2,
        "to": 9,
        "label": "data_dep: inventory"
      },
      {
        "from": 3,
        "to": 9,
        "label": "data_dep: repair_kit_id"
      },
      {
        "from": 8,
        "to": 9,
        "label": "data_dep: kits_to_consume"
      },
      {
        "from": 8,
        "to": 9,
        "label": "data_dep: kits_to_consume"
      },
      {
        "from": 10,
        "to": 10,
        "label": "def: amount_to_use"
      },
      {
        "from": 8,
        "to": 10,
        "label": "data_dep: kits_to_consume"
      },
      {
        "from": 10,
        "to": 11,
        "label": "data_dep: amount_to_use"
      },
      {
        "from": 8,
        "to": 12,
        "label": "data_dep: kits_to_consume"
      },
      {
        "from": 10,
        "to": 12,
        "label": "data_dep: amount_to_use"
      },
      {
        "from": 2,
        "to": 13,
        "label": "data_dep: inventory"
      }
    ]
  }
]