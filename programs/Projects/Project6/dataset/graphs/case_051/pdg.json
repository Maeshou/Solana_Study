[
  {
    "name": "cast_meteor_spell",
    "inputs": [
      "ctx: Context < CastAbility >",
      "damage_multiplier: u32"
    ],
    "nodes": [
      {
        "id": 0,
        "label": "Entry"
      },
      {
        "id": 1,
        "label": "let character = & mut ctx . accounts . player_character ;"
      },
      {
        "id": 2,
        "label": "let monster = & mut ctx . accounts . monster ;"
      },
      {
        "id": 3,
        "label": "let clock = Clock :: get () ? ;"
      },
      {
        "id": 4,
        "label": "character . stats . current_mana = character . stats . current_mana . saturating_sub (150) ;"
      },
      {
        "id": 5,
        "label": "let base_damage = character . stats . intelligence * damage_multiplier ;"
      },
      {
        "id": 6,
        "label": "let final_damage = base_damage . saturating_sub (monster . magic_resistance) ;"
      },
      {
        "id": 7,
        "label": "monster . current_health = monster . current_health . saturating_sub (final_damage as u64) ;"
      },
      {
        "id": 8,
        "label": "character . last_ability_timestamp = clock . unix_timestamp + 300 ;"
      },
      {
        "id": 9,
        "label": "msg ! (\"Meteor cast! Dealt {} damage.\" , final_damage) ;"
      },
      {
        "id": 10,
        "label": "Ok (())"
      }
    ],
    "edges": [
      {
        "from": 1,
        "to": 1,
        "label": "def: character"
      },
      {
        "from": 2,
        "to": 2,
        "label": "def: monster"
      },
      {
        "from": 3,
        "to": 3,
        "label": "def: clock"
      },
      {
        "from": 1,
        "to": 4,
        "label": "data_dep: character"
      },
      {
        "from": 1,
        "to": 4,
        "label": "data_dep: character"
      },
      {
        "from": 5,
        "to": 5,
        "label": "def: base_damage"
      },
      {
        "from": 1,
        "to": 5,
        "label": "data_dep: character"
      },
      {
        "from": 6,
        "to": 6,
        "label": "def: final_damage"
      },
      {
        "from": 5,
        "to": 6,
        "label": "data_dep: base_damage"
      },
      {
        "from": 2,
        "to": 6,
        "label": "data_dep: monster"
      },
      {
        "from": 2,
        "to": 7,
        "label": "data_dep: monster"
      },
      {
        "from": 2,
        "to": 7,
        "label": "data_dep: monster"
      },
      {
        "from": 6,
        "to": 7,
        "label": "data_dep: final_damage"
      },
      {
        "from": 1,
        "to": 8,
        "label": "data_dep: character"
      },
      {
        "from": 3,
        "to": 8,
        "label": "data_dep: clock"
      }
    ]
  }
]