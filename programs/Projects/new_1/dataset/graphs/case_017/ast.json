[
  {
    "name": "enhance",
    "node_type": "function",
    "fields": null,
    "inputs": [
      "ctx: Context < Enhance2 >"
    ],
    "attributes": [],
    "body": [
      "let ts = ctx . accounts . clock . unix_timestamp as u64 ;",
      "let rand = ts . wrapping_mul (6364136223846793005) . wrapping_add (1) . wrapping_shr (32) % 100 ;",
      "let result = & mut ctx . accounts . result ;",
      "result . user = * ctx . accounts . user . key ;",
      "result . timestamp = ts ;",
      "result . random_value = rand as u8 ;",
      "result . participant_mints = [ctx . accounts . nft1_mint . key () , ctx . accounts . nft2_mint . key () , ctx . accounts . nft3_mint . key () , ctx . accounts . nft4_mint . key () , ctx . accounts . nft5_mint . key () ,] ;",
      "result . outcome_rank = match rand { 0 ..= 79 => 1 , 80 ..= 89 => 2 , 90 ..= 97 => 3 , _ => 4 , } ;",
      "emit ! (EnhanceStateEvent { user : * ctx . accounts . user . key , rank : result . outcome_rank , random : result . random_value , }) ;",
      "Ok (())"
    ]
  },
  {
    "name": "Enhance2",
    "node_type": "struct",
    "fields": [
      {
        "name": "user",
        "attribute": "# [doc = \" 合成実行者（署名必須）\"] # [account (mut)]",
        "field_type": "Signer < 'info >"
      },
      {
        "name": "nft1_account",
        "attribute": "# [doc = \" 合成に使う５つの NFT トークンアカウントを自動クローズ\"] # [account (mut , close = user)]",
        "field_type": "Account < 'info , TokenAccount >"
      },
      {
        "name": "nft2_account",
        "attribute": "# [account (mut , close = user)]",
        "field_type": "Account < 'info , TokenAccount >"
      },
      {
        "name": "nft3_account",
        "attribute": "# [account (mut , close = user)]",
        "field_type": "Account < 'info , TokenAccount >"
      },
      {
        "name": "nft4_account",
        "attribute": "# [account (mut , close = user)]",
        "field_type": "Account < 'info , TokenAccount >"
      },
      {
        "name": "nft5_account",
        "attribute": "# [account (mut , close = user)]",
        "field_type": "Account < 'info , TokenAccount >"
      },
      {
        "name": "nft1_mint",
        "attribute": "# [doc = \" 元の NFT Mint アドレス\"]",
        "field_type": "Account < 'info , Mint >"
      },
      {
        "name": "nft2_mint",
        "attribute": null,
        "field_type": "Account < 'info , Mint >"
      },
      {
        "name": "nft3_mint",
        "attribute": null,
        "field_type": "Account < 'info , Mint >"
      },
      {
        "name": "nft4_mint",
        "attribute": null,
        "field_type": "Account < 'info , Mint >"
      },
      {
        "name": "nft5_mint",
        "attribute": null,
        "field_type": "Account < 'info , Mint >"
      },
      {
        "name": "result",
        "attribute": "# [doc = \" 合成結果を記録するカスタム状態アカウント\"] # [account (init , payer = user , space = 8 + 32 + 8 + 1 + (5 * 32) + 1)]",
        "field_type": "Account < 'info , EnhanceResult >"
      },
      {
        "name": "system_program",
        "attribute": null,
        "field_type": "Program < 'info , System >"
      },
      {
        "name": "rent",
        "attribute": null,
        "field_type": "Sysvar < 'info , Rent >"
      },
      {
        "name": "clock",
        "attribute": null,
        "field_type": "Sysvar < 'info , Clock >"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "EnhanceResult",
    "node_type": "struct",
    "fields": [
      {
        "name": "user",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "timestamp",
        "attribute": null,
        "field_type": "u64"
      },
      {
        "name": "random_value",
        "attribute": null,
        "field_type": "u8"
      },
      {
        "name": "participant_mints",
        "attribute": null,
        "field_type": "[Pubkey ; 5]"
      },
      {
        "name": "outcome_rank",
        "attribute": null,
        "field_type": "u8"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  },
  {
    "name": "EnhanceStateEvent",
    "node_type": "struct",
    "fields": [
      {
        "name": "user",
        "attribute": null,
        "field_type": "Pubkey"
      },
      {
        "name": "rank",
        "attribute": null,
        "field_type": "u8"
      },
      {
        "name": "random",
        "attribute": null,
        "field_type": "u8"
      }
    ],
    "inputs": null,
    "attributes": null,
    "body": null
  }
]